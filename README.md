
# ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ø§ÛŒÙ†ØªØ±Ù†ØªÛŒ Ø¢Ø´Ù¾Ø²Ø®ÙˆÙ†Ù‡ (Ashpazkhoneh)

ÛŒÚ© Ù¾Ù„ØªÙØ±Ù… ÙØ±ÙˆØ´Ú¯Ø§Ù‡ÛŒ Ù…Ø¯Ø±Ù† Ùˆ Ù„ÙˆÚ©Ø³ Ø¨Ø±Ø§ÛŒ Ù„ÙˆØ§Ø²Ù… Ø®Ø§Ù†Ù‡ Ùˆ Ø¢Ø´Ù¾Ø²Ø®Ø§Ù†Ù‡ØŒ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯Ù‡ Ø¨Ø§ React Ùˆ Tailwind CSS. Ø§ÛŒÙ† Ù¾Ø±ÙˆÚ˜Ù‡ Ø´Ø§Ù…Ù„ Ø¨Ø®Ø´â€ŒÙ‡Ø§ÛŒ ÙØ±ÙˆØ´Ú¯Ø§Ù‡ØŒ Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ø§Ù…Ù„ØŒ ÙˆØ¨Ù„Ø§Ú¯ Ùˆ Ø¯Ø³ØªÛŒØ§Ø± Ù‡ÙˆØ´Ù…Ù†Ø¯ Ø¢Ø´Ù¾Ø²ÛŒ Ù…Ø¨ØªÙ†ÛŒ Ø¨Ø± Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ø§Ø³Øª.

## ğŸš€ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§

- **ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ú©Ø§Ù…Ù„:** Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ Ù…Ø­ØµÙˆÙ„Ø§ØªØŒ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ØŒ Ù„ÛŒØ³Øª Ø¹Ù„Ø§Ù‚Ù‡â€ŒÙ…Ù†Ø¯ÛŒâ€ŒÙ‡Ø§ Ùˆ Ù¾Ø±ÙˆØ³Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª.
- **Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ù¾ÛŒØ´Ø±ÙØªÙ‡:** Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ø­ØµÙˆÙ„Ø§ØªØŒ Ø³ÙØ§Ø±Ø´Ø§ØªØŒ Ú©Ø§Ø±Ø¨Ø±Ø§Ù†ØŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø³Ø§ÛŒØª Ùˆ Ø§Ø³Ù„Ø§ÛŒØ¯Ø±Ù‡Ø§.
- **Ø¯Ø³ØªÛŒØ§Ø± Ù‡ÙˆØ´Ù…Ù†Ø¯ (AI Chef):** Ù¾Ø§Ø³Ø®Ú¯ÙˆÛŒÛŒ Ø¨Ù‡ Ø³ÙˆØ§Ù„Ø§Øª Ø¢Ø´Ù¾Ø²ÛŒ Ùˆ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒÛŒ Ø®Ø±ÛŒØ¯ Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Gemini AI.
- **Ø·Ø±Ø§Ø­ÛŒ Ù…Ø¯Ø±Ù†:** Ø±Ø§Ø¨Ø· Ú©Ø§Ø±Ø¨Ø±ÛŒ ÙˆØ§Ú©Ù†Ø´â€ŒÚ¯Ø±Ø§ (Responsive) Ùˆ Ø§Ù†ÛŒÙ…ÛŒØ´Ù†â€ŒÙ‡Ø§ÛŒ Ø±ÙˆØ§Ù†.
- **Ø¨Ø¯ÙˆÙ† Ù†ÛŒØ§Ø² Ø¨Ù‡ Backend (MVP):** Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² LocalStorage Ø¨Ø±Ø§ÛŒ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ùˆ Ø¹Ù…Ù„ÛŒØ§Øª CRUD.

---

## ğŸ›  Ù¾ÛŒØ´â€ŒÙ†ÛŒØ§Ø²Ù‡Ø§

Ø¨Ø±Ø§ÛŒ Ø§Ø¬Ø±Ø§ÛŒ Ø§ÛŒÙ† Ù¾Ø±ÙˆÚ˜Ù‡ Ø¨Ù‡ Ù…ÙˆØ§Ø±Ø¯ Ø²ÛŒØ± Ù†ÛŒØ§Ø² Ø¯Ø§Ø±ÛŒØ¯:
- **Node.js** (Ù†Ø³Ø®Ù‡ Û±Û¸ ÛŒØ§ Ø¨Ø§Ù„Ø§ØªØ±)
- **npm** ÛŒØ§ **yarn**

---

## ğŸ’» Ù†ØµØ¨ Ùˆ Ø§Ø¬Ø±Ø§ (Ù„ÙˆÚ©Ø§Ù„)

Û±. Ù¾Ø±ÙˆÚ˜Ù‡ Ø±Ø§ Ú©Ù„ÙˆÙ† Ú©Ù†ÛŒØ¯ ÛŒØ§ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ Ø±Ø§ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù†Ù…Ø§ÛŒÛŒØ¯.
Û². Ø¯Ø± Ù¾ÙˆØ´Ù‡ Ù¾Ø±ÙˆÚ˜Ù‡ ØªØ±Ù…ÛŒÙ†Ø§Ù„ Ø±Ø§ Ø¨Ø§Ø² Ú©Ù†ÛŒØ¯.
Û³. Ø¯Ø³ØªÙˆØ± Ø²ÛŒØ± Ø±Ø§ Ø¨Ø±Ø§ÛŒ Ù†ØµØ¨ ÙˆØ§Ø¨Ø³ØªÚ¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ (Ø³Ø±ÙˆØ± Ø§Ø³ØªØ§ØªÛŒÚ©) Ø§Ø¬Ø±Ø§ Ú©Ù†ÛŒØ¯:

```bash
npm install
```

Û´. Ø¨Ø±Ø§ÛŒ Ø§Ø¬Ø±Ø§ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡:

```bash
npm start
```

Ù¾Ø±ÙˆÚ˜Ù‡ Ø¯Ø± Ø¢Ø¯Ø±Ø³ `http://localhost:3000` Ø¯Ø± Ø¯Ø³ØªØ±Ø³ Ø®ÙˆØ§Ù‡Ø¯ Ø¨ÙˆØ¯.

---

## ğŸŒ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø§Ø³ØªÙ‚Ø±Ø§Ø± Ø±ÙˆÛŒ Ø³Ø±ÙˆØ± (Ù†ØµØ¨ Ø§ØªÙˆÙ…Ø§ØªÛŒÚ© Ø¨Ø§ SSL)

Ø¨Ø±Ø§ÛŒ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø³Ø±ÛŒØ¹ Ù¾Ø±ÙˆÚ˜Ù‡ Ø±ÙˆÛŒ Ø³Ø±ÙˆØ± (VPS)ØŒ Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ø²ÛŒØ± ØªÙ…Ø§Ù… Ù…Ø±Ø§Ø­Ù„ Ù†ØµØ¨ØŒ Ú©Ø§Ù†ÙÛŒÚ¯ Ø¯ÛŒØªØ§Ø¨ÛŒØ³ØŒ ØªÙ†Ø¸ÛŒÙ… Ø¯Ø§Ù…Ù†Ù‡ØŒ Ø¯Ø±ÛŒØ§ÙØª SSL Ùˆ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø±Ø§ Ø¨Ù‡ ØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ø§Ù†Ø¬Ø§Ù… Ù…ÛŒâ€ŒØ¯Ù‡Ø¯.

Û±. Ø¯Ø± Ø³Ø±ÙˆØ± Ø®ÙˆØ¯ ÛŒÚ© ÙØ§ÛŒÙ„ Ø¬Ø¯ÛŒØ¯ Ø§ÛŒØ¬Ø§Ø¯ Ú©Ù†ÛŒØ¯:
```bash
nano install.bash
```

Û². Ú©Ø¯Ù‡Ø§ÛŒ Ø²ÛŒØ± Ø±Ø§ Ø¯Ø± Ø¢Ù† Ú©Ù¾ÛŒ Ú©Ù†ÛŒØ¯:

```bash
#!/bin/bash

# Colors for better visibility
GREEN='\033[0;32m'
BLUE='\033[0;34m'
RED='\033[0;31m'
NC='\033[0m' # No Color

echo -e "${BLUE}=========================================${NC}"
echo -e "${BLUE}   Ashpazkhoneh Auto Installer   ${NC}"
echo -e "${BLUE}=========================================${NC}"

# Check for root privileges
if [ "$EUID" -ne 0 ]; then
  echo -e "${RED}Please run this script as root or with sudo.${NC}"
  exit
fi

# 1. Gather Configuration
echo ""
echo -e "${GREEN}--- Domain & Network Settings ---${NC}"
read -p "Domain Name (without http/www, e.g., example.com): " DOMAIN_NAME
read -p "Email for SSL Certificate (e.g., info@example.com): " SSL_EMAIL
read -p "App Internal Port [Default: 3000]: " APP_PORT
APP_PORT=${APP_PORT:-3000}

echo ""
echo -e "${GREEN}--- Database Settings ---${NC}"
read -p "Database Name: " DB_NAME
read -p "Database User: " DB_USER
read -s -p "Database Password: " DB_PASS
echo ""

echo ""
echo -e "${GREEN}--- Admin Settings ---${NC}"
read -p "Admin Username: " ADMIN_USER
read -p "Admin Email: " ADMIN_EMAIL
read -s -p "Admin Password: " ADMIN_PASS
echo ""

# 2. Save Configuration to .env
echo ""
echo "Saving configuration..."
cat > .env << EOL
PORT=$APP_PORT
DB_HOST=localhost
DB_NAME=$DB_NAME
DB_USER=$DB_USER
DB_PASS=$DB_PASS
ADMIN_INIT_USER=$ADMIN_USER
ADMIN_INIT_EMAIL=$ADMIN_EMAIL
ADMIN_INIT_PASS=$ADMIN_PASS
EOL
echo ".env file created."

# 3. System Update & Dependencies
echo ""
echo "Updating system and installing Node.js, Nginx, and Certbot..."
apt update
curl -fsSL https://deb.nodesource.com/setup_20.x | bash -
apt install -y nodejs nginx certbot python3-certbot-nginx

# 4. Install Process Managers
echo ""
echo "Installing PM2 and Serve..."
npm install -g pm2 serve

# 5. Install Project Dependencies
echo ""
echo "Installing project packages..."
if [ -f "package.json" ]; then
    npm install
else
    echo "package.json not found. Initializing temporary setup..."
    npm init -y
    npm install serve
fi

# 6. Start Application with PM2
echo ""
echo "Starting application on port $APP_PORT..."
pm2 delete ashpazkhoneh 2>/dev/null
pm2 start serve --name "ashpazkhoneh" -- -s . -l $APP_PORT
pm2 save
pm2 startup

# 7. Configure Nginx Reverse Proxy
echo ""
echo "Configuring Nginx..."

# Create Nginx Config
cat > /etc/nginx/sites-available/$DOMAIN_NAME << EOL
server {
    listen 80;
    server_name $DOMAIN_NAME www.$DOMAIN_NAME;

    location / {
        proxy_pass http://localhost:$APP_PORT;
        proxy_http_version 1.1;
        proxy_set_header Upgrade \$http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host \$host;
        proxy_cache_bypass \$http_upgrade;
    }
}
EOL

# Enable Site
# Force link creation (-f) to overwrite if exists
ln -sf /etc/nginx/sites-available/$DOMAIN_NAME /etc/nginx/sites-enabled/

# Cleanup default config and broken links
echo "Cleaning up Nginx configuration..."
rm /etc/nginx/sites-enabled/default 2>/dev/null
# CRITICAL FIX: Remove broken symlinks that cause "No such file or directory" errors
find -L /etc/nginx/sites-enabled/ -type l -delete

# Test and Restart Nginx
nginx -t
if [ $? -eq 0 ]; then
    systemctl restart nginx
    echo "Nginx configured successfully."
else
    echo -e "${RED}Nginx configuration failed.${NC}"
    exit 1
fi

# 8. SSL & HTTPS
echo ""
echo "Obtaining SSL Certificate & Enabling HTTPS..."
echo -e "${BLUE}Note: Ensure your domain ($DOMAIN_NAME) points to this server IP.${NC}"

certbot --nginx --non-interactive --agree-tos --redirect -m $SSL_EMAIL -d $DOMAIN_NAME -d www.$DOMAIN_NAME

if [ $? -eq 0 ]; then
    echo ""
    echo -e "${GREEN}=========================================${NC}"
    echo -e "${GREEN}   Installation Complete!   ${NC}"
    echo -e "${GREEN}=========================================${NC}"
    echo -e "Your site is now secure and accessible at:"
    echo -e "https://$DOMAIN_NAME"
    echo ""
    echo -e "All HTTP traffic is redirected to HTTPS."
else
    echo ""
    echo -e "${RED}SSL Installation Failed.${NC}"
    echo "Please check your DNS settings."
    echo "Your site is temporarily available at http://$DOMAIN_NAME"
fi
```

Û³. ÙØ§ÛŒÙ„ Ø±Ø§ Ø°Ø®ÛŒØ±Ù‡ Ú©Ø±Ø¯Ù‡ (`Ctrl+O`, `Enter`) Ùˆ Ø®Ø§Ø±Ø¬ Ø´ÙˆÛŒØ¯ (`Ctrl+X`).

Û´. Ø¨Ù‡ Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ø¯Ø³ØªØ±Ø³ÛŒ Ø§Ø¬Ø±Ø§ Ø¨Ø¯Ù‡ÛŒØ¯ Ùˆ Ø¢Ù† Ø±Ø§ Ø§Ø¬Ø±Ø§ Ú©Ù†ÛŒØ¯:

```bash
chmod +x install.bash
sudo ./install.bash
```

---

## âš™ï¸ Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ù…Ø­ÛŒØ·ÛŒ (Environment Variables)

Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ø¨Ø§Ù„Ø§ ÛŒÚ© ÙØ§ÛŒÙ„ `.env` Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒâ€ŒÚ©Ù†Ø¯. Ø§Ú¯Ø±Ú†Ù‡ Ù†Ø³Ø®Ù‡ ÙØ¹Ù„ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡ (MVP) Ø§Ø² `localStorage` Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ØŒ Ø§ÛŒÙ† ÙØ§ÛŒÙ„ Ø¨Ø±Ø§ÛŒ Ø§ØªØµØ§Ù„ Ø¨Ù‡ Backend ÙˆØ§Ù‚Ø¹ÛŒ (Node.js/NestJS) Ø¯Ø± Ø¢ÛŒÙ†Ø¯Ù‡ Ø¶Ø±ÙˆØ±ÛŒ Ø§Ø³Øª.

Ù†Ù…ÙˆÙ†Ù‡ ÙØ§ÛŒÙ„ `.env` ØªÙˆÙ„ÛŒØ¯ Ø´Ø¯Ù‡:
```env
PORT=3000
DB_NAME=ashpaz_db
DB_USER=root
DB_PASS=secret
ADMIN_INIT_USER=admin
ADMIN_INIT_EMAIL=admin@example.com
ADMIN_INIT_PASS=123456
```

---

## ğŸ“‚ Ø³Ø§Ø®ØªØ§Ø± Ù¾Ø±ÙˆÚ˜Ù‡

- `components/`: Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øªâ€ŒÙ‡Ø§ÛŒ Ø±Ø§Ø¨Ø· Ú©Ø§Ø±Ø¨Ø±ÛŒ
- `pages/`: ØµÙØ­Ø§Øª Ø§ØµÙ„ÛŒ
- `services/`: Ø³Ø±ÙˆÛŒØ³â€ŒÙ‡Ø§ÛŒ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ùˆ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ
- `types.ts`: ØªØ¹Ø§Ø±ÛŒÙ ØªØ§ÛŒÙ¾â€ŒÙ‡Ø§ÛŒ TypeScript
- `constants.ts`: Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø«Ø§Ø¨Øª
